name: End-To-End
on:
  push:
    branches:
      - master
jobs:
  cypress-run:
    runs-on: ubuntu-20.04
    container: cypress/base:14.19.0
    steps:
      - uses: actions/checkout@v2
      - uses: cypress-io/github-action@v4
        env:
          NODE_TLS_REJECT_UNAUTHORIZED: 0
        with:
          working-directory: 'packages/webcert-e2e'
          install-command: yarn --frozen-lockfile --silent
          build: yarn workspace @frontend/common build
          start: yarn workspace @frontend/webcert dev -m test
          wait-on: 'https://127.0.0.1:3000'
          command: yarn workspace @frontend/webcert-e2e cypress run
            --config baseUrl=https://127.0.0.1:3000,screenshotOnRunFailure=false
            --env grepTags=@react,grepFilterSpecs=true
