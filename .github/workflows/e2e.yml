name: End-To-End
on: [push]
jobs:
  cypress-run:
    runs-on: ubuntu-20.04
    container: cypress/base:14.19.0
    steps:
      - uses: actions/checkout@v2
      - uses: cypress-io/github-action@v4
        with:
          working-directory: 'packages/webcert-e2e'
          install-command: yarn --frozen-lockfile --silent
          build: yarn turbo build
          start: yarn workspace @frontend/webcert start:test
          wait-on: 'http://127.0.0.1:3000'
          command: yarn workspace @frontend/webcert-e2e cypress run
            --config baseUrl=http://127.0.0.1:3000,screenshotOnRunFailure=false
            --env grepTags=@react,grepFilterSpecs=true
